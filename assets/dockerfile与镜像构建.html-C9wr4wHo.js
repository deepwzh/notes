import{_ as s,c as a,a as e,o as l}from"./app-BCPqHasI.js";const i={};function t(p,n){return l(),a("div",null,n[0]||(n[0]=[e(`<h1 id="dockerfile-与镜像构建" tabindex="-1"><a class="header-anchor" href="#dockerfile-与镜像构建"><span>dockerfile 与镜像构建</span></a></h1><p>Dockerfiles 与镜像构建</p><h1 id="docker-镜像相关命令" tabindex="-1"><a class="header-anchor" href="#docker-镜像相关命令"><span>Docker 镜像相关命令</span></a></h1><h2 id="镜像构建" tabindex="-1"><a class="header-anchor" href="#镜像构建"><span>镜像构建</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">docker</span> built <span class="token parameter variable">-t</span> docker-image-name <span class="token builtin class-name">.</span> <span class="token parameter variable">-f</span> hello.Dockerfiles</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="镜像推送" tabindex="-1"><a class="header-anchor" href="#镜像推送"><span>镜像推送</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">docker</span> tag docker-image-name <span class="token punctuation">[</span>dockerhub.example.com/lib/docker-image-name:v1.0.0<span class="token punctuation">]</span><span class="token punctuation">(</span>http://dockerhub.example.com/lib/docker-image-name:v1.0.0<span class="token punctuation">)</span><span class="token punctuation">[</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">(</span>http://dockerhub.example.com/lib/docker-image-name:v1.0.0<span class="token punctuation">)</span>docker login <span class="token punctuation">[</span>dockerhub.example.com/lib/docker-image-name<span class="token punctuation">]</span><span class="token punctuation">(</span>http://dockerhub.example.com/lib/docker-image-name:v1.0.0<span class="token punctuation">)</span><span class="token punctuation">[</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">(</span>http://dockerhub.example.com/lib/docker-image-name:v1.0.0<span class="token punctuation">)</span>docker push <span class="token punctuation">[</span>dockerhub.example.com/lib/docker-image-name:v1.0.0<span class="token punctuation">]</span><span class="token punctuation">(</span>http://dockerhub.example.com/lib/docker-image-name:v1.0.0<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="dockerfile-模板" tabindex="-1"><a class="header-anchor" href="#dockerfile-模板"><span>Dockerfile 模板</span></a></h1><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code><span class="line"><span class="token instruction"><span class="token keyword">FROM</span> image_name:tag</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">ADD</span> . /dir_in_container</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> file1 /dir_in_container/file1</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> touch /dir_in_container/file2 <span class="token operator">\\</span></span>
<span class="line">   &amp;&amp; mkdir -p /dir_in_container/datadir</span></span>
<span class="line">   </span>
<span class="line"><span class="token instruction"><span class="token keyword">workdir</span> /dir_in_container</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;-c&quot;</span>, <span class="token string">&quot;echo&quot;</span>, <span class="token string">&quot;Hello World&quot;</span>]</span></span>
<span class="line">**ENTRYPOINT [&quot;/bin/bash&quot;]**</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="常用模板" tabindex="-1"><a class="header-anchor" href="#常用模板"><span>常用模板</span></a></h2><h3 id="debian-系统" tabindex="-1"><a class="header-anchor" href="#debian-系统"><span>debian 系统</span></a></h3><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code><span class="line"><span class="token instruction"><span class="token keyword">FROM</span> debian:latest</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">&quot;s@deb.debian.org@mirrors.163.com@g&quot;</span> /etc/apt/sources.list <span class="token operator">\\</span></span>
<span class="line">  &amp;&amp; apt-get install -y git <span class="token operator">\\</span></span>
<span class="line">  &amp;&amp; apt-get clean <span class="token operator">\\</span></span>
<span class="line">  &amp;&amp; echo <span class="token string">&quot;Hello World&quot;</span>  </span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">workdir</span> /data</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;-c&quot;</span>, <span class="token string">&quot;echo&quot;</span>, <span class="token string">&quot;Hello World&quot;</span>]</span></span>
<span class="line">**ENTRYPOINT [&quot;/bin/bash&quot;]**</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ubuntu-系统" tabindex="-1"><a class="header-anchor" href="#ubuntu-系统"><span>Ubuntu 系统</span></a></h3><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code><span class="line"><span class="token instruction"><span class="token keyword">FROM</span> debian:latest</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">&quot;s@deb.debian.org@mirrors.163.com@g&quot;</span> /etc/apt/sources.list <span class="token operator">\\</span></span>
<span class="line">  &amp;&amp; apt-get install -y git <span class="token operator">\\</span></span>
<span class="line">  &amp;&amp; apt-get clean <span class="token operator">\\</span></span>
<span class="line">  &amp;&amp; echo <span class="token string">&quot;Hello World&quot;</span>  </span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">workdir</span> /data</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;-c&quot;</span>, <span class="token string">&quot;echo&quot;</span>, <span class="token string">&quot;Hello World&quot;</span>]</span></span>
<span class="line">**ENTRYPOINT [&quot;/bin/bash&quot;]**</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="alpine-系统-体积较小" tabindex="-1"><a class="header-anchor" href="#alpine-系统-体积较小"><span>alpine 系统（体积较小）</span></a></h3><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker"><pre><code><span class="line"><span class="token instruction"><span class="token keyword">FROM</span> alpine:latest</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> sed -i <span class="token string">&#39;s/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g&#39;</span> /etc/apk/repositories <span class="token operator">\\</span></span>
<span class="line">  &amp;&amp; apk add --no-cache git <span class="token operator">\\</span></span>
<span class="line">  &amp;&amp; echo <span class="token string">&quot;Hello World&quot;</span> </span></span>
<span class="line"><span class="token instruction"><span class="token keyword">workdir</span> /data</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;-c&quot;</span>, <span class="token string">&quot;echo&quot;</span>, <span class="token string">&quot;Hello World&quot;</span>]</span></span>
<span class="line">**ENTRYPOINT [&quot;/bin/bash&quot;]**</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>带有 docker,helm 的镜像</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">// 替换镜像源 [debian | 镜像站使用帮助 | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror</span>
<span class="line">](https://mirrors.tuna.tsinghua.edu.cn/help/debian/)// 安装docker [Install Docker Engine on Debian | Docker Documentation</span>
<span class="line">](https://docs.docker.com/engine/install/debian/)// 安装helm [Helm | 安装Helm](https://helm.sh/zh/docs/intro/install/)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code><span class="line"><span class="token comment"># 创建一个远程服务器</span></span>
<span class="line">docker context <span class="token keyword">create</span> example<span class="token operator">-</span>server \\</span>
<span class="line">  <span class="token comment">--description &quot;connection to example server&quot; \\</span></span>
<span class="line">  <span class="token comment">--docker &quot;host=tcp://your-remote-server.org:2375&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 指定一个远程服务器运行docker命令</span></span>
<span class="line">docker <span class="token comment">--context example-server ps</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 或者切换一个远程服务器</span></span>
<span class="line">docker context <span class="token keyword">use</span> example<span class="token operator">-</span>server</span>
<span class="line">docker ps</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://netcore.run/2020/04/24/windows-connect-remote-docker/" target="_blank" rel="noopener noreferrer">在 Windows 中使用 docker-cli 连接远程的 docker-engine (非 Docker for Windows) – 川 (netcore.run)</a></p><h2 id="常用镜像" tabindex="-1"><a class="header-anchor" href="#常用镜像"><span>常用镜像</span></a></h2><h3 id="python3" tabindex="-1"><a class="header-anchor" href="#python3"><span>python3</span></a></h3><table><tr><td><br></td><td>os<br></td><td>版本<br></td><td>备注<br></td></tr><tr><td>python:3.9-alpine<br></td><td>alpine<br></td><td>3.9<br></td><td>体积较小，越xxMB<br></td></tr><tr><td>python:3.9-slim<br></td><td><br></td><td><br></td><td>体积较小，越xxMB<br></td></tr><tr><td><br></td><td><br></td><td><br></td><td><br></td></tr></table><h1 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h1><p><a href="https://www.cnblogs.com/sparkdev/p/8461576.html" target="_blank" rel="noopener noreferrer">Dockerfile 中的 CMD 与 ENTRYPOINT - sparkdev - 博客园 (cnblogs.com)</a></p><p><a href="https://docs.docker.com/engine/reference/builder/#exec-form-entrypoint-example" target="_blank" rel="noopener noreferrer">官方 Dockerfile reference | Docker Documentation</a></p><p><a href="https://cloud.tencent.com/document/product/457/68383#.3Cstrong.3E2.8-dockerfile-jmeter-grafana-reporter.3C.2Fstrong.3E" target="_blank" rel="noopener noreferrer">容器服务 镜像分层最佳实践-最佳实践-文档中心-腾讯云 (tencent.com)</a></p>`,27)]))}const c=s(i,[["render",t]]),o=JSON.parse('{"path":"/%E4%BA%91%E5%8E%9F%E7%94%9F/Docker/dockerfile%E4%B8%8E%E9%95%9C%E5%83%8F%E6%9E%84%E5%BB%BA.html","title":"dockerfile 与镜像构建","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"镜像构建","slug":"镜像构建","link":"#镜像构建","children":[]},{"level":2,"title":"镜像推送","slug":"镜像推送","link":"#镜像推送","children":[]},{"level":2,"title":"常用模板","slug":"常用模板","link":"#常用模板","children":[{"level":3,"title":"debian 系统","slug":"debian-系统","link":"#debian-系统","children":[]},{"level":3,"title":"Ubuntu 系统","slug":"ubuntu-系统","link":"#ubuntu-系统","children":[]},{"level":3,"title":"alpine 系统（体积较小）","slug":"alpine-系统-体积较小","link":"#alpine-系统-体积较小","children":[]}]},{"level":2,"title":"常用镜像","slug":"常用镜像","link":"#常用镜像","children":[{"level":3,"title":"python3","slug":"python3","link":"#python3","children":[]}]}],"git":{},"filePathRelative":"云原生/Docker/dockerfile与镜像构建.md"}');export{c as comp,o as data};
