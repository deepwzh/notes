import{_ as s,c as a,a as t,o as p}from"./app-EGhza7Qr.js";const o={};function c(u,n){return p(),a("div",null,n[0]||(n[0]=[t(`<h1 id="pandas" tabindex="-1"><a class="header-anchor" href="#pandas"><span>Pandas</span></a></h1><h1 id="示例" tabindex="-1"><a class="header-anchor" href="#示例"><span>示例</span></a></h1><h2 id="时序数据分析" tabindex="-1"><a class="header-anchor" href="#时序数据分析"><span>时序数据分析</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2022-04-01T12:09:46.929+0800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;op&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;query&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;cost&quot;</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&quot;db_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;dbname&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span>df_data<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;op&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;cost&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;db_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">df<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>_</span>
<span class="line">_pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&quot;display.max_rows&quot;</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span></span>
<span class="line">time_group <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;2022-04-01 00:00:00&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2022-04-01 23:59:05&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;db_name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">&quot;60Min&quot;</span><span class="token punctuation">)</span>_</span>
<span class="line">_print<span class="token punctuation">(</span>time_group<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">&quot;avg_cost&quot;</span><span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token string">&quot;max_arg&quot;</span><span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token keyword">not</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>empty <span class="token keyword">else</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&quot;min&quot;</span><span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;min_arg&quot;</span><span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>idxmin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token keyword">not</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>empty <span class="token keyword">else</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&quot;median&quot;</span><span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;count&quot;</span><span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">&quot;cost&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4)]))}const l=s(o,[["render",c]]),i=JSON.parse('{"path":"/Python/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97%E7%9B%B8%E5%85%B3/Pandas.html","title":"Pandas","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"时序数据分析","slug":"时序数据分析","link":"#时序数据分析","children":[]}],"git":{},"filePathRelative":"Python/科学计算相关/Pandas.md"}');export{l as comp,i as data};
